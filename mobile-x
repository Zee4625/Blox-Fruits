-- LocalScript √Æn StarterPlayerScripts

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- === Admin Restriction ===
local Admins = {
    ["YourUsername"] = true,  -- schimbƒÉ cu numele tƒÉu Roblox
}

if not Admins[LocalPlayer.Name] then
    return -- nu e admin, nu continua scriptul
end

-- === GUI Setup ===
local ScreenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "AlonexZeePanel"
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 240, 0, 360)
Frame.Position = UDim2.new(0, 20, 0.5, -180)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true

local UIListLayout = Instance.new("UIListLayout", Frame)
UIListLayout.Padding = UDim.new(0, 6)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 10)

local function createButton(text, parent, callback)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, -16, 0, 34)
    button.Position = UDim2.new(0, 8, 0, 0)
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    button.TextColor3 = Color3.new(1, 1, 1)
    button.Text = text
    button.Font = Enum.Font.GothamBold
    button.TextSize = 16
    button.AutoButtonColor = true
    button.Parent = parent

    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(0, 6)

    button.MouseButton1Click:Connect(callback)
    return button
end

local function createTextBox(placeholder, parent)
    local box = Instance.new("TextBox")
    box.Size = UDim2.new(1, -16, 0, 30)
    box.Position = UDim2.new(0, 8, 0, 0)
    box.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    box.TextColor3 = Color3.new(1,1,1)
    box.PlaceholderText = placeholder
    box.Font = Enum.Font.Gotham
    box.TextSize = 14
    box.ClearTextOnFocus = false
    box.Parent = parent

    local corner = Instance.new("UICorner", box)
    corner.CornerRadius = UDim.new(0, 6)

    return box
end

-- Variables
local flying = false
local flySpeed = 50
local noclipOn = false
local btoolsOn = false
local highlightOn = false

-- Fly Implementation
local BodyGyro, BodyVelocity

local function startFly()
    if flying then return end
    flying = true

    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local root = char:WaitForChild("HumanoidRootPart")

    BodyGyro = Instance.new("BodyGyro")
    BodyGyro.P = 9e4
    BodyGyro.maxTorque = Vector3.new(9e9, 9e9, 9e9)
    BodyGyro.CFrame = root.CFrame
    BodyGyro.Parent = root

    BodyVelocity = Instance.new("BodyVelocity")
    BodyVelocity.Velocity = Vector3.new(0,0,0)
    BodyVelocity.MaxForce = Vector3.new(9e9,9e9,9e9)
    BodyVelocity.Parent = root

    local cam = workspace.CurrentCamera

    RunService:BindToRenderStep("FlyStep", Enum.RenderPriority.Character.Value, function()
        if not flying then
            BodyGyro:Destroy()
            BodyVelocity:Destroy()
            RunService:UnbindFromRenderStep("FlyStep")
            return
        end

        BodyGyro.CFrame = cam.CFrame
        BodyVelocity.Velocity = cam.CFrame.LookVector * flySpeed
    end)
end

local function stopFly()
    flying = false
end

-- Speed Change
local function setSpeed(speed)
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = char:WaitForChild("Humanoid")
    humanoid.WalkSpeed = speed
end

-- Highlight toggle
local function toggleHighlight()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hl = char:FindFirstChildOfClass("Highlight")

    if hl then
        hl:Destroy()
        highlightOn = false
    else
        local highlight = Instance.new("Highlight", char)
        highlight.FillColor = Color3.fromRGB(255, 255, 0)
        highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
        highlightOn = true
    end
end

-- Invisibility toggle
local invisible = false
local function toggleInvisibility()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    if not invisible then
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Transparency = 1
            elseif part:IsA("Decal") then
                part.Transparency = 1
            end
        end
        invisible = true
    else
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Transparency = 0
            elseif part:IsA("Decal") then
                part.Transparency = 0
            end
        end
        invisible = false
    end
end

-- Teleport to player
local function teleportToPlayer(targetName)
    local target = Players:FindFirstChild(targetName)
    if not target or not target.Character or not target.Character:FindFirstChild("HumanoidRootPart") then
        warn("Player not found or not loaded")
        return
    end
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local root = char:WaitForChild("HumanoidRootPart")

    root.CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0)
end

-- Kill player
local function killPlayer(targetName)
    local target = Players:FindFirstChild(targetName)
    if not target or not target.Character then
        warn("Player not found or not loaded")
        return
    end
    local humanoid = target.Character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.Health = 0
    end
end

-- Noclip toggle
local function toggleNoclip()
    noclipOn = not noclipOn
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

    if noclipOn then
        RunService:BindToRenderStep("Noclip", Enum.RenderPriority.Character.Value, function()
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end)
    else
        RunService:UnbindFromRenderStep("Noclip")
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

-- Btools (delete part on click)
local mouse = LocalPlayer:GetMouse()
local function enableBtools()
    btoolsOn = true
    mouse.Button1Down:Connect(function()
        if btoolsOn and mouse.Target and mouse.Target:IsDescendantOf(workspace) then
            mouse.Target:Destroy()
        end
    end)
end
local function disableBtools()
    btoolsOn = false
end

-- Buttons & Inputs

-- Fly Toggle button
createButton("üïäÔ∏è Fly (Z Toggle)", Frame, function()
    -- toggle fly on Z press
    UIS.InputBegan:Connect(function(input, gpe)
        if gpe then return end
        if input.KeyCode == Enum.KeyCode.Z then
            if flying then
                stopFly()
            else
                startFly()
            end
        end
    end)
end)

-- Speed buttons
createButton("‚ö° Speed x3", Frame, function()
    setSpeed(48)
end)
createButton("üö∂ Reset Speed", Frame, function()
    setSpeed(16)
end)

-- Highlight toggle
createButton("üî¶ Toggle Highlight", Frame, function()
    toggleHighlight()
end)

-- Invisibility toggle
createButton("üëª Toggle Invisibility", Frame, function()
    toggleInvisibility()
end)

-- Teleport input + button
local tpBox = createTextBox("Player Name to Teleport", Frame)
local tpBtn = createButton("üìç Teleport To Player", Frame, function()
    local targetName = tpBox.Text
    if targetName ~= "" then
        teleportToPlayer(targetName)
    end
end)

-- Kill input + button
local killBox = createTextBox("Player Name to Kill", Frame)
local killBtn = createButton("üíÄ Kill Player", Frame, function()
    local targetName = killBox.Text
    if targetName ~= "" then
        killPlayer(targetName)
    end
end)

-- Noclip toggle
createButton("üö´ Toggle Noclip", Frame, function()
    toggleNoclip()
end)

-- Btools toggle
local btoolsToggle = createButton("üõ†Ô∏è Enable Btools", Frame, function()
    if not btoolsOn then
        enableBtools()
        btoolsToggle.Text = "üõ†Ô∏è Disable Btools"
    else
        disableBtools()
        btoolsToggle.Text = "üõ†Ô∏è Enable Btools"
    end
end)

-- Close/Open Panel button
local toggleBtn = Instance.new("TextButton", ScreenGui)
toggleBtn.Size = UDim2.new(0, 100, 0, 30)
toggleBtn.Position = UDim2.new(0, 20, 1, -50)
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 16
toggleBtn.Text = "Toggle Panel"

local corner = Instance.new("UICorner", toggleBtn)
corner.CornerRadius = UDim.new(0, 8)

toggleBtn.MouseButton1Click:Connect(function()
    Frame.Visible = not Frame.Visible
end)

-- Init speed normal on spawn
setSpeed(16)

-- Reset states on character respawn
LocalPlayer.CharacterAdded:Connect(function()
    stopFly()
    setSpeed(16)
    invisible = false
    highlightOn = false
    noclipOn = false
    disableBtools()
end)
